<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= config.name %> - Server Status</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
    <style>
        :root {
            --primary-color: #5865F2;
            --success-color: #57F287;
            --danger-color: #ED4245;
            --warning-color: #FEE75C;
            --background: #1a1a1a;
        }
        
        body {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        .card {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .online { background-color: var(--success-color); box-shadow: 0 0 10px var(--success-color); }
        .offline { background-color: var(--danger-color); box-shadow: 0 0 10px var(--danger-color); }
        
        .player-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid var(--primary-color);
        }
        
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            transition: width 0.5s ease;
        }
        
        .blink {
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .gradient-text {
            background: linear-gradient(45deg, var(--primary-color), var(--success-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .server-icon {
            width: 64px;
            height: 64px;
            border-radius: 12px;
            border: 3px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="text-white">
    <!-- Navigation -->
    <nav class="bg-gray-900/80 backdrop-blur-lg border-b border-gray-800 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-server text-2xl text-purple-500"></i>
                    <h1 class="text-2xl font-bold gradient-text"><%= config.name %></h1>
                </div>
                <div class="flex items-center space-x-6">
                    <a href="#status" class="hover:text-purple-400 transition">Status</a>
                    <a href="#players" class="hover:text-purple-400 transition">Players</a>
                    <a href="#info" class="hover:text-purple-400 transition">Info</a>
                    <a href="#charts" class="hover:text-purple-400 transition">Charts</a>
                    <a href="<%= config.social.discord %>" target="_blank" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition">
                        <i class="fab fa-discord mr-2"></i>Join Discord
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="container mx-auto px-4 py-12">
        <div class="text-center mb-12">
            <h2 class="text-4xl md:text-5xl font-bold mb-4">
                <span class="gradient-text">UnixMc</span> Status Monitor
            </h2>
            <p class="text-xl text-gray-400 max-w-2xl mx-auto">
                Real-time monitoring and statistics for <%= config.name %> Minecraft server
            </p>
        </div>

        <!-- Status Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12" id="status">
            <!-- Server Status Card -->
            <div class="card rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">Server Status</h3>
                        <div class="flex items-center">
                            <span class="status-indicator <%= server.online ? 'online' : 'offline' %>"></span>
                            <span class="text-2xl font-bold">
                                <%= server.online ? 'ONLINE' : 'OFFLINE' %>
                            </span>
                        </div>
                    </div>
                    <i class="fas fa-server text-3xl text-gray-600"></i>
                </div>
                <p class="text-gray-400">Last checked: <span id="lastChecked"></span></p>
            </div>

            <!-- Players Card -->
            <div class="card rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">Players Online</h3>
                        <div class="text-3xl font-bold">
                            <%= server.players.online %> / <%= server.players.max %>
                        </div>
                    </div>
                    <i class="fas fa-users text-3xl text-blue-500"></i>
                </div>
                <div class="progress-bar mt-2">
                    <div class="progress-fill" style="width: <%= (server.players.online / server.players.max) * 100 %>%;"></div>
                </div>
            </div>

            <!-- Version Card -->
            <div class="card rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">Version</h3>
                        <div class="text-2xl font-bold"><%= server.version %></div>
                    </div>
                    <i class="fas fa-code-branch text-3xl text-green-500"></i>
                </div>
                <p class="text-gray-400">Type: <%= config.serverType.toUpperCase() %></p>
            </div>

            <!-- Performance Card -->
            <div class="card rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">Uptime</h3>
                        <div class="text-3xl font-bold"><%= uptime %>%</div>
                    </div>
                    <i class="fas fa-chart-line text-3xl text-yellow-500"></i>
                </div>
                <p class="text-gray-400">24-hour average</p>
            </div>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Server Info -->
                <div class="card rounded-xl p-6" id="info">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold">Server Information</h3>
                        <div class="flex items-center space-x-2">
                            <img src="<%= server.icon || 'https://api.mcsrvstat.us/icon/127.0.0.1' %>" 
                                 alt="Server Icon" class="server-icon">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold text-purple-400 mb-2">Connection</h4>
                            <p class="text-xl font-mono bg-gray-900 p-3 rounded">
                                <%= config.hosts[0].ip %>:<%= config.hosts[0].port %>
                            </p>
                            <button onclick="copyIP()" class="mt-3 w-full bg-purple-600 hover:bg-purple-700 py-2 rounded-lg transition">
                                <i class="fas fa-copy mr-2"></i>Copy IP
                            </button>
                        </div>
                        
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-400 mb-2">Quick Stats</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>Response Time:</span>
                                    <span class="font-mono"><%= server.responseTime %>ms</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Software:</span>
                                    <span><%= server.software || 'Vanilla' %></span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Location:</span>
                                    <span><%= config.location %></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold text-green-400 mb-3">Features</h4>
                        <div class="flex flex-wrap gap-2">
                            <% config.features.forEach(feature => { %>
                                <span class="bg-green-900/30 text-green-300 px-3 py-1 rounded-full text-sm">
                                    <%= feature %>
                                </span>
                            <% }) %>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold text-yellow-400 mb-3">MOTD</h4>
                        <div class="bg-gray-900 p-4 rounded-lg">
                            <% if (server.motd && server.motd.clean) { %>
                                <% server.motd.clean.forEach(line => { %>
                                    <p class="mb-1"><%= line %></p>
                                <% }) %>
                            <% } else { %>
                                <p class="text-gray-500">No MOTD available</p>
                            <% } %>
                        </div>
                    </div>
                </div>

                <!-- Players List -->
                <div class="card rounded-xl p-6" id="players">
                    <h3 class="text-2xl font-bold mb-6">Online Players</h3>
                    
                    <% if (server.online && server.players.online > 0) { %>
                        <% if (server.players.list && server.players.list.length > 0) { %>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                <% server.players.list.forEach(player => { %>
                                    <div class="bg-gray-800/50 rounded-lg p-4 text-center hover:bg-gray-800 transition">
                                        <div class="w-12 h-12 bg-purple-600 rounded-full mx-auto mb-3 flex items-center justify-center">
                                            <i class="fas fa-user text-white"></i>
                                        </div>
                                        <p class="font-medium truncate"><%= player %></p>
                                    </div>
                                <% }) %>
                            </div>
                        <% } else { %>
                            <div class="text-center py-8">
                                <i class="fas fa-users text-5xl text-gray-600 mb-4"></i>
                                <p class="text-gray-400"><%= server.players.online %> players online</p>
                                <p class="text-sm text-gray-500">Player list not available for this server type</p>
                            </div>
                        <% } %>
                    <% } else { %>
                        <div class="text-center py-8">
                            <i class="fas fa-user-slash text-5xl text-gray-600 mb-4"></i>
                            <p class="text-gray-400">No players online</p>
                        </div>
                    <% } %>
                    
                    <div class="mt-6 pt-6 border-t border-gray-800">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-400">Player Statistics</span>
                            <span class="font-bold">
                                <%= server.players.online %> / <%= server.players.max %> online
                                (<%= ((server.players.online / server.players.max) * 100).toFixed(1) %>%)
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="space-y-8">
                <!-- Live Stats -->
                <div class="card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-chart-bar mr-2 text-blue-400"></i>
                        Live Statistics
                    </h3>
                    
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-400">Server Uptime</span>
                                <span class="font-bold"><%= uptime %>%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: <%= uptime %>%"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-gray-400">API Response Time</span>
                                <span class="font-mono"><%= analytics.performance.averageResponseTime.toFixed(2) %>ms</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: <%= Math.min(analytics.performance.averageResponseTime / 100, 100) %>%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 pt-4 border-t border-gray-800">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-blue-400"><%= analytics.requests.total %></div>
                                <div class="text-sm text-gray-400">Total Requests</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-green-400"><%= analytics.performance.peakPlayers %></div>
                                <div class="text-sm text-gray-400">Peak Players</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Social Links -->
                <div class="card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-share-alt mr-2 text-purple-400"></i>
                        Connect With Us
                    </h3>
                    
                    <div class="space-y-3">
                        <a href="<%= config.social.discord %>" target="_blank" 
                           class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg hover:bg-gray-800 transition">
                            <div class="flex items-center">
                                <i class="fab fa-discord text-2xl text-blue-500 mr-3"></i>
                                <span>Discord</span>
                            </div>
                            <i class="fas fa-external-link-alt text-gray-500"></i>
                        </a>
                        
                        <% if (config.social.website && config.social.website !== 'coming soon') { %>
                        <a href="<%= config.social.website %>" target="_blank" 
                           class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg hover:bg-gray-800 transition">
                            <div class="flex items-center">
                                <i class="fas fa-globe text-2xl text-green-500 mr-3"></i>
                                <span>Website</span>
                            </div>
                            <i class="fas fa-external-link-alt text-gray-500"></i>
                        </a>
                        <% } %>
                        
                        <% if (config.social.twitter) { %>
                        <a href="<%= config.social.twitter %>" target="_blank" 
                           class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg hover:bg-gray-800 transition">
                            <div class="flex items-center">
                                <i class="fab fa-twitter text-2xl text-blue-400 mr-3"></i>
                                <span>Twitter</span>
                            </div>
                            <i class="fas fa-external-link-alt text-gray-500"></i>
                        </a>
                        <% } %>
                        
                        <% if (config.social.youtube) { %>
                        <a href="<%= config.social.youtube %>" target="_blank" 
                           class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg hover:bg-gray-800 transition">
                            <div class="flex items-center">
                                <i class="fab fa-youtube text-2xl text-red-500 mr-3"></i>
                                <span>YouTube</span>
                            </div>
                            <i class="fas fa-external-link-alt text-gray-500"></i>
                        </a>
                        <% } %>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-bolt mr-2 text-yellow-400"></i>
                        Quick Actions
                    </h3>
                    
                    <div class="space-y-3">
                        <button onclick="refreshStatus()" 
                                class="w-full flex items-center justify-center p-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh Status
                        </button>
                        
                        <button onclick="copyIP()" 
                                class="w-full flex items-center justify-center p-3 bg-purple-600 hover:bg-purple-700 rounded-lg transition">
                            <i class="fas fa-copy mr-2"></i>Copy Server IP
                        </button>
                        
                        <a href="<%= config.social.discord %>" target="_blank"
                           class="block w-full text-center p-3 bg-gray-800 hover:bg-gray-700 rounded-lg transition">
                            <i class="fab fa-discord mr-2"></i>Join Support Discord
                        </a>
                    </div>
                </div>

                <!-- System Status -->
                <div class="card rounded-xl p-6">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-heartbeat mr-2 text-red-400"></i>
                        System Health
                    </h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="status-indicator online mr-2"></span>
                                <span>API Status</span>
                            </div>
                            <span class="font-mono text-green-400">Healthy</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="status-indicator online mr-2"></span>
                                <span>Cache Status</span>
                            </div>
                            <span class="font-mono text-green-400">Active</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-database mr-2 text-gray-400"></i>
                                <span>History Size</span>
                            </div>
                            <span class="font-mono"><%= history.length %> entries</span>
                        </div>
                        
                        <div class="pt-4 border-t border-gray-800">
                            <div class="text-center">
                                <div class="text-sm text-gray-400">Last Updated</div>
                                <div class="font-mono text-xs" id="updateTimer">Just now</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 pt-8 border-t border-gray-800 text-center text-gray-500">
            <div class="container mx-auto">
                <p class="mb-4">
                    <%= config.name %> Server Status Monitor • Version 2.0 • Made By ❤️ Hopingboyz
                </p>
                <div class="flex justify-center space-x-6">
                    <a href="/api/health" class="hover:text-white transition">API Health</a>
                    <a href="/api/status" class="hover:text-white transition">Raw API</a>
                    <a href="<%= config.social.discord %>" class="hover:text-white transition">Support</a>
                </div>
                <p class="mt-4 text-sm">
                    &copy; <%= new Date().getFullYear() %> <%= config.owner %>. All rights reserved.
                    Minecraft is a trademark of Mojang Studios.
                </p>
            </div>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        // Update timer
        let lastUpdate = new Date();
        
        function updateTimer() {
            const now = new Date();
            const diff = Math.floor((now - lastUpdate) / 1000);
            
            if (diff < 60) {
                document.getElementById('updateTimer').textContent = `${diff} seconds ago`;
            } else if (diff < 3600) {
                document.getElementById('updateTimer').textContent = `${Math.floor(diff / 60)} minutes ago`;
            } else {
                document.getElementById('updateTimer').textContent = `${Math.floor(diff / 3600)} hours ago`;
            }
        }
        
        // Update last checked
        document.getElementById('lastChecked').textContent = new Date().toLocaleTimeString();
        
        // Refresh status function
        async function refreshStatus() {
            const refreshBtn = event?.target || document.querySelector('button[onclick="refreshStatus()"]');
            const originalText = refreshBtn.innerHTML;
            
            refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Refreshing...';
            refreshBtn.disabled = true;
            
            try {
                const response = await fetch('/api/status?cache=false');
                const data = await response.json();
                
                if (data.success) {
                    // Reload the page to show updated data
                    location.reload();
                } else {
                    alert('Failed to refresh status');
                }
            } catch (error) {
                console.error('Refresh error:', error);
                alert('Error refreshing status');
            } finally {
                refreshBtn.innerHTML = originalText;
                refreshBtn.disabled = false;
            }
        }
        
        // Copy IP function
        function copyIP() {
            const ip = '<%= config.hosts[0].ip %>:<%= config.hosts[0].port %>';
            navigator.clipboard.writeText(ip)
                .then(() => {
                    const btn = event?.target?.closest('button') || event?.target;
                    if (btn) {
                        const originalText = btn.innerHTML;
                        btn.innerHTML = '<i class="fas fa-check mr-2"></i>Copied!';
                        setTimeout(() => {
                            btn.innerHTML = originalText;
                        }, 2000);
                    }
                })
                .catch(err => {
                    console.error('Copy error:', err);
                    alert('Failed to copy IP');
                });
        }
        
        // Auto-refresh every 30 seconds
        setInterval(() => {
            fetch('/api/status')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Update live elements without full page reload
                        document.querySelector('.status-indicator').className = 
                            `status-indicator ${data.data.online ? 'online' : 'offline'}`;
                        
                        document.querySelector('.status-indicator + .text-2xl').textContent = 
                            data.data.online ? 'ONLINE' : 'OFFLINE';
                        
                        const playerElement = document.querySelector('.text-3xl.font-bold');
                        if (playerElement) {
                            playerElement.textContent = `${data.data.players.online} / ${data.data.players.max}`;
                        }
                        
                        const progressFill = document.querySelector('.progress-fill');
                        if (progressFill) {
                            const percentage = (data.data.players.online / data.data.players.max) * 100;
                            progressFill.style.width = `${percentage}%`;
                        }
                        
                        lastUpdate = new Date(data.timestamp);
                        updateTimer();
                    }
                })
                .catch(console.error);
        }, 30000);
        
        // Update timer every minute
        setInterval(updateTimer, 60000);
        
        // Initialize
        updateTimer();
    </script>
</body>
</html>